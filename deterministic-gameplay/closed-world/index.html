<!doctype html><html lang=kr class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="할락의 노트"><link href=https://halak.github.io/deterministic-gameplay/closed-world/ rel=canonical><meta name=author content="HALAK SHIN"><link rel="shortcut icon" href=../../favicon.ico><meta name=generator content="mkdocs-1.1.2, mkdocs-material-5.5.7"><title>닫힌 세계 - 할락</title><link rel=stylesheet href=../../assets/stylesheets/main.b8ac9624.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.28f3ef9a.min.css><meta name=theme-color content=#546e7a><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../assets/stylesheets/theme.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-165576766-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=blue-grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://halak.github.io/ title=할락 class="md-header-nav__button md-logo" aria-label=할락> <img src=../../assets/images/logo.svg alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> 할락 </span> <span class="md-header-nav__topic md-ellipsis"> 닫힌 세계 </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=검색 placeholder=검색 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://halak.github.io/ title=할락 class="md-nav__button md-logo" aria-label=할락> <img src=../../assets/images/logo.svg alt=logo> </a> 할락 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=머리말 class=md-nav__link> 머리말 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> 부동 소수점 <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="부동 소수점" data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> 부동 소수점 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ieee754/ title="IEEE 754" class=md-nav__link> IEEE 754 </a> </li> <li class=md-nav__item> <a href=../../ieee754/binary32/ title="부동 소수점 시뮬레이터 (32bit)" class=md-nav__link> 부동 소수점 시뮬레이터 (32bit) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../poisson-ratio/ title="푸아송 비와 애니메이션" class=md-nav__link> 푸아송 비와 애니메이션 </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4 checked> <label class=md-nav__link for=nav-4> 결정론적 게임 플레이 <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="결정론적 게임 플레이" data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> 결정론적 게임 플레이 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ title=들어가며 class=md-nav__link> 들어가며 </a> </li> <li class=md-nav__item> <a href=../game-loop/ title="게임 루프" class=md-nav__link> 게임 루프 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 닫힌 세계 <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=./ title="닫힌 세계" class="md-nav__link md-nav__link--active"> 닫힌 세계 </a> <nav class="md-nav md-nav--secondary" aria-label=목차> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> 목차 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 내부 상태 관리 </a> <nav class=md-nav aria-label="내부 상태 관리"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 컨테이너 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 외부 입력 처리 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../pseudo-random/ title="의사 난수" class=md-nav__link> 의사 난수 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../confusing-unicode/ title="헷갈리기 쉬운 유니코드" class=md-nav__link> 헷갈리기 쉬운 유니코드 </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=목차> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> 목차 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 내부 상태 관리 </a> <nav class=md-nav aria-label="내부 상태 관리"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 컨테이너 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 외부 입력 처리 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=_1>닫힌 세계<a class=headerlink href=#_1 title="Permanent link">&para;</a></h1> <p>결정론적인 게임플레이 프로그래밍을 위해서는 닫힌 세계에 대하여 이해하여야합니다.</p> <h2 id=_2>내부 상태 관리<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <h3 id=_3>컨테이너<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>컨테이너 혹은 컬렉션은 구현 레벨에서 데이터를 순회할 때 순서를 보장하는지 여부를 기준으로 나눌 수 있습니다.<br> 여기서 순서를 보장한다는 것은 입력한 순서대로 가져올 수 있는지 여부를 말하는 것이 아닙니다.<br> 같은 데이터를 가지고 있는 컨테이너들끼리는 같은 순서로 데이터를 순회할 수 있어야한다는 것입니다. 순서를 보장하는 <code>System.Collections.Generic.List&lt;T&gt;</code>, <code>std::vector&lt;T&gt;</code>와 같은 컨테이너들은 그냥 평소와 같이 사용하면 됩니다.<br></p> <p>신경써야할 컨테이너들은 순서를 보장하지 않는 컨테이너들입니다. 대표적으로 <code>System.Collection.Generic.Dictionary&lt;TKey, TValue&gt;</code>, <code>std::unordered_map&lt;&gt;</code>이 있습니다. 주로 해시 값을 기반으로 하는 컨테이너들인데 이론상 <span><span class=MathJax_Preview>O(1)</span><script type=math/tex>O(1)</script></span> 시간에 삽입, 삭제, 탐색을 할 수 있어서 자주 사용합니다. <code>std::unordered_map&lt;&gt;</code>은 이름에서도 어필하듯 순서를 보장하지 않습니다.</p> <p>이론상 해시 함수는 같은 데이터에 대하여 동일한 해시 값을 반환해야합니다. 하지만 C#이나 Java와 같은 언어에서의 <code>class</code>들은 별도로 해시 함수를 정의하지 않으면 객체의 ID에 해당하는 값을 반환합니다. 이는 사실상 무작위에 가깝습니다.</p> <p>그리고 보안 문제로 같은 데이터에 대하여 프로세스, 빌드에 따라 다른 해시 값을 반환하는 런타임도 있습니다. <a href=https://referencesource.microsoft.com/#mscorlib/system/string.cs,0a17bbac4851d0d4><code>System.String.GetHashCode()</code></a>의 구현을 보면 디스크와 같은 저장소에 해시 값을 보관하지 말라는 주석이 달려있습니다.</p> <p>해시 값이 달라지면 데이터가 보관되는 버킷이 달라지는건 말할 것도 없고, 만일 해시 값이 같더라도 버킷 크기에 따라 해시 충돌로 저장되는 버킷이 달라질 수 있습니다. 버킷이 달라지면 같은 데이터를 보관하는 컨테이너들이라도 같은 순서로 데이터를 가져올 수 있으리라는 보장을 할 수 없습니다.</p> <p>결정론적인 게임플레이 코드에서 순서를 보장하지 않는 컨테이너들을 순회할 때는 명시적으로 정렬한 후 순회해야합니다.</p> <div class=highlight><pre><span></span><code><span class=kt>var</span> <span class=n>names</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>&gt;()</span> <span class=p>{</span> <span class=s>&quot;John&quot;</span><span class=p>,</span> <span class=s>&quot;Bob&quot;</span><span class=p>,</span> <span class=s>&quot;Halak&quot;</span> <span class=p>};</span>
<span class=k>foreach</span> <span class=p>(</span><span class=kt>var</span> <span class=n>name</span> <span class=k>in</span> <span class=n>names</span><span class=p>.</span><span class=n>OrderBy</span><span class=p>(</span><span class=n>name</span> <span class=p>=&gt;</span> <span class=n>name</span><span class=p>,</span> <span class=n>StringComparer</span><span class=p>.</span><span class=n>Ordinal</span><span class=p>))</span>
<span class=p>{</span>
    <span class=c1>// ...</span>
<span class=p>}</span>
</code></pre></div> <h2 id=_4>외부 입력 처리<a class=headerlink href=#_4 title="Permanent link">&para;</a></h2> <p><em>작성 중</em></p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../game-loop/ title="게임 루프" class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> 이전 </span> 게임 루프 </div> </div> </a> <a href=../pseudo-random/ title="의사 난수" class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> 다음 </span> 의사 난수 </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/halak target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/halakshin target=_blank rel=noopener title=twitter.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.d1f5a259.min.js></script> <script src=../../assets/javascripts/bundle.d5fec882.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "\ud074\ub9bd\ubcf4\ub4dc\ub85c \ubcf5\uc0ac", "clipboard.copied": "\ud074\ub9bd\ubcf4\ub4dc\uc5d0 \ubcf5\uc0ac\ub428", "search.config.lang": "en", "search.config.pipeline": " ", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694", "search.result.none": "\uac80\uc0c9\uc5b4\uc640 \uc77c\uce58\ud558\ub294 \ubb38\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4", "search.result.one": "1\uac1c\uc758 \uc77c\uce58\ud558\ub294 \ubb38\uc11c", "search.result.other": "#\uac1c\uc758 \uc77c\uce58\ud558\ub294 \ubb38\uc11c"}</script> <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.fae956e7.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src=../../assets/javascripts/main.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>